<!DOCTYPE html> <html lang=en> <head> <meta charset=utf-8> <meta content='IE=edge' http-equiv=X-UA-Compatible> <meta content='width=device-width, initial-scale=1' name=viewport> <title>Preparing a Windows Executor - Cider-Ci Documentation</title> <link href="../../../assets/stylesheets/app-30beb77e.css" rel=stylesheet /> <script src="../../../assets/javascripts/vendor-ce938919.js"></script> <script src="../../../assets/javascripts/app-72be183c.js"></script> </head> <body id=the-cider-ci-documentation> <div class=container> <nav class='navbar navbar-inverse'> <div class=container-fluid> <div class=navbar-header> <a class=navbar-brand href="../../../">Cider-CI <span class=semantic-version><span class=major>4</span><span class=divider>.</span><span class=minor>0</span><span class=divider>.</span><span class=patch>0</span><span class=divider>-</span><span class=pre>BETA.3</span><span class=divider>+</span><span class=build>1</span></span> Documentation </a></div> <form action='https://www.google.com/search' class='navbar-form navbar-left' method=get role=search> <div class=form-group> <input name=as_sitesearch type=hidden value='docs.cider-ci.info'> <input name=hl type=hidden value=en> <input class=form-control name=as_q placeholder=Search> <button class='btn btn-default' style='display: none' type=submit>Submit</button> </div> </form> <ul class='nav navbar-nav'> <li> <a href="../../../introduction/">Introduction </a></li> <li> <a href="../../../introduction/quick-start/">Quick-Start </a></li> <li> <a href="../../../sitemap.html">Sitemap </a></li> </ul> </div> </nav> <div class=row> <div class=col-md-6> <ol class=breadcrumb> <li> <a href="../../../">Home </a></li> <li> <a href="../../">Installation </a></li> <li> <a href="../">Setup and Deploy </a></li> <li> <a href="./">Windows Preparation </a></li> </ol> </div> <div class=col-md-6> </div> </div> <div class=content> <div class="alert alert-danger"> <p>TODO: This part of the documentation is partly outdated and needs to be updated for Cider-CI 4.</p> </div> <h1 class=no_toc id=preparing-a-windows-executor>Preparing a Windows Executor</h1> <p>This page guides through the process of installing a Cider-CI environment.</p> <h3 class=no_toc id=table-of-contents>Table of Contents</h3> <ul id=markdown-toc> <li><a id=markdown-toc-introduction href="#introduction">Introduction</a></li> <li><a id=markdown-toc-prerequisites href="#prerequisites">Prerequisites</a></li> <li><a id=markdown-toc-configuring-the-windows-machine-and-the-control-machine-for-ansible href="#configuring-the-windows-machine-and-the-control-machine-for-ansible">Configuring the Windows Machine and the Control Machine for Ansible</a></li> <li><a id=markdown-toc-required-additional-software-for-cider-ci href="#required-additional-software-for-cider-ci">Required Additional Software for Cider-CI</a></li> <li><a id=markdown-toc-users-and-access href="#users-and-access">Users and Access</a></li> <li><a id=markdown-toc-inventory href="#inventory">The Inventory</a></li> </ul> <h2 id=introduction>Introduction</h2> <p>Cider-CI supports executors on Windows systems as of version 3.7 "Redmond". Automatizing configuration of a Windows system has become practical with <em>Powershell Remoting</em>. This is what Ansible is using under the hood.</p> <p>Setting up <em>Powershell Remoting</em> is however nowhere as quick as preparing a Linux system. The effective lack of a standard software repository for the operating system adds to the time necessary to prepare the system.</p> <p class=text-warning>We do not recommend to set up a Windows machine unless you are fairly sure that you really need one. You can expect that the setup of the Windows machine alone will take more time as configuring all the rest of a Cider-CI environment.</p> <p>You can take this as a good sing of how easy the rest of Cider-CI to set up. Also, if you have performed the initial setup for Windows you are done with respect to Cider-CI. Installation and future upgrades<sup id="fnref:1"><a href="#fn:1" class=footnote>1</a></sup> are fully automatized.</p> <h2 id=prerequisites>Prerequisites</h2> <p>Cider-CI supports currently only 64 bit versions of Windows. We are testing with a "Windows Server 2008", and a new "Windows 10" instance. We expect that anything in between will work, too.</p> <p class=text-warning>The firewall of the system must be set so that the protocols mentioned in the <a href="..">Setup and Deploy Guide</a> are not impaired. Windows systems come with a set of so called <em>Group Policies</em>. Some settings can interfere with the proper working of a Cider-CI executor. Larger organizations often modify and enforced customized <em>Group Policies</em> in their environment.</p> <h2 id=configuring-the-windows-machine-and-the-control-machine-for-ansible>Configuring the Windows Machine and the Control Machine for Ansible</h2> <p>The control machine must have access via <a href="https://msdn.microsoft.com/en-us/library/aa384426(v=vs.85).aspx">Windows Powershell Remoting</a> to <strong>all Windows executors</strong>. Read and follow the instructions on the <a href="http://docs.ansible.com/ansible/intro_windows.html">Windows Support</a> page of the Ansible documentation.</p> <h2 id=required-additional-software-for-cider-ci>Required Additional Software for Cider-CI</h2> <p>A Cider-CI executor on Windows requires the following extra software to be installed on the machine.</p> <ol> <li> <p>A Java JDK of version 7 or later.</p> </li> <li> <p>A recent version of Git. Make sure that the git executable is added to the path during install.</p> </li> <li> <p>The <em>F#</em> programming language. More precisely: make sure that the following path <code>C:\Program Files (x86)\Microsoft SDKs\F#\4.0\Framework\v4.0\Fsi.exe</code> is working properly.</p> </li> </ol> <p>All of the mentioned software should preferably installed for all users of the system. Precise rules for finer granulated configuration can be deduced from the following section.</p> <h2 id=users-and-access>Users and Access</h2> <p>The deploy script requires a local user which is in the <em>Windows Administrators Group</em>. The account name and password must be defined in your inventory configuration[^deploy-account]. This user will only be used during deploys and upgrades. The default settings should bring all required permissions to operate properly. <span class=text-warning> Check your possibly customized <em>Group Policies</em> if there are problems during deploy. </span></p> <p>The deploy process will create (if not already present) a second user with the account name <code>cider-ci_executor</code>. The Cider-CI executor service will run under this account and scripts under normal operation will be executed as this user too. <span class=text-warning> This is different to how a Linux executor will work in default mode where there is a separation between service and execution user. </span> The reason for proceeding in this way on Windows is related to so called <a href="https://en.wikipedia.org/wiki/Shatter_attack">Shatter attacks</a>.</p> <p>The deploy process will add <code>cider-ci_executor</code> to the <em>Users</em> group but not to any other group, e.g. <em>Administrators</em>. The password of the this user must be configured in your inventory and it may not be changed after the deploy.</p> <h2 id=inventory>The Inventory</h2> <div class=row> <div class=col-md-6> <p>We keep the host specific parameters in a separate file in the directory <code>host_vars</code> relative to the <code>hosts</code> file. The file name must match to name of the machine in the <code>hosts</code> file which is <code>windows-executor</code> respectively <code>windows-executor.yml</code> in our case. See also the <a href="../#inventory">inventory section</a> in the general <a href="../">Setup and Deploy Guide</a></p> <p class=text-warning>The <code>ansible_ssh...</code> named variables for the windows executor are misnomers introduced by Ansible for obscure reasons. There is nothing going on via the <code>SSH</code> protocol, the <code>WinRM</code> protocol is effectively used all the time.</p> </div> <div class=col-md-6> <div class=highlighter-coderay><div class=CodeRay> <div class=code><pre><span class="line-numbers"> <a href="#n1" name="n1">1</a></span><span style="color:#777"># Configuration for the windows-executor in the advanced demo</span>
<span class="line-numbers"> <a href="#n2" name="n2">2</a></span>
<span class="line-numbers"> <a href="#n3" name="n3">3</a></span><span style="color:#606">ansible_connection</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">winrm</span></span>
<span class="line-numbers"> <a href="#n4" name="n4">4</a></span>
<span class="line-numbers"> <a href="#n5" name="n5">5</a></span><span style="color:#777"># login for the local administrator account, TO BE ADJUSTED</span>
<span class="line-numbers"> <a href="#n6" name="n6">6</a></span><span style="color:#606">ansible_ssh_user</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">root</span></span>
<span class="line-numbers"> <a href="#n7" name="n7">7</a></span><span style="color:#777"># password for the local administrator account, TO BE REPLACED</span>
<span class="line-numbers"> <a href="#n8" name="n8">8</a></span><span style="color:#606">ansible_ssh_pass</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">root</span></span>
<span class="line-numbers"> <a href="#n9" name="n9">9</a></span>
<span class="line-numbers"><strong><a href="#n10" name="n10">10</a></strong></span><span style="color:#777"># password for the execution user, TO BE REPLACED</span>
<span class="line-numbers"><a href="#n11" name="n11">11</a></span><span style="color:#606">win_executor_user_password</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">secret</span></span>
<span class="line-numbers"><a href="#n12" name="n12">12</a></span>
<span class="line-numbers"><a href="#n13" name="n13">13</a></span><span style="color:#777"># enabled for pull mode only</span>
<span class="line-numbers"><a href="#n14" name="n14">14</a></span><span style="color:#606">executor_base_url</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">NULL</span></span>
</pre></div> </div> </div> </div> </div> <div class=footnotes> <ol> <li id="fn:1"> <p>As long as Cider-CI does not get a larger upgrade which requires a higher version of Java for instance. Things like this happen very rarely. <a href="#fnref:1" class=reversefootnote>&#8617;</a></p> </li> </ol> </div> </div> </div> </body> </html>