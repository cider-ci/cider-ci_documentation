<!DOCTYPE html> <html lang=en> <head> <meta charset=utf-8> <meta content='IE=edge' http-equiv=X-UA-Compatible> <meta content='width=device-width, initial-scale=1' name=viewport> <title>Cider-CI Docs</title> <link href="../assets/stylesheets/app-dc48fd15.css" rel=stylesheet /> <script src="../assets/javascripts/vendor-e7dce3cb.js"></script> <script src="../assets/javascripts/app-72be183c.js"></script> <script src="../assets/javascripts/analytics-5b6b61dc.js"></script> </head> <body id=the-cider-ci-documentation> <div class=container> <nav class='navbar navbar-inverse'> <div class=container-fluid> <div class=navbar-header> <a class=navbar-brand href="../">Cider-CI <span class=semantic-version><span class=major>3</span><span class=divider>.</span><span class=minor>7</span></span> Documentation </a></div> <form action='https://www.google.com/search' class='navbar-form navbar-left' method=get role=search> <div class=form-group> <input name=as_sitesearch type=hidden value='docs.cider-ci.info'> <input class=form-control name=as_q placeholder=Search> <button class='btn btn-default' style='display: none' type=submit>Submit</button> </div> </form> <ul class='nav navbar-nav'> <li> <a href="../introduction/">Introduction </a></li> <li> <a href="../introduction/quick-start/">Quick-Start </a></li> <li> <a href="../sitemap.html">Sitemap </a></li> </ul> </div> </nav> <div class=row> <div class=col-md-6> </div> <div class=col-md-6> </div> </div> <div class=content> <h1 id=advanced-installation>Advanced Installation</h1> <div class="alert alert-danger" role=alert> <p>This page is outdated. It will be updated for version 3.7 "Redmond".</p> </div> <h3 class=no_toc id=table-of-contents>Table of Contents</h3> <ul id=markdown-toc> <li><a id=markdown-toc-advanced-installation href="#advanced-installation">Advanced Installation</a> <ul> <li><a id=markdown-toc-installation-options href="#installation-options">Installation Options</a> <ul> <li><a id=markdown-toc-admin href="#admin">Admin</a></li> <li><a id=markdown-toc-user-interface-theme href="#user-interface-theme">User-Interface Theme</a></li> <li><a id=markdown-toc-reseting-the-master-secret href="#reseting-the-master-secret">Reseting the Master-Secret</a></li> </ul> </li> <li><a id=markdown-toc-production-environment href="#production-environment">Production Environment</a></li> <li><a id=markdown-toc-upgrading-and-redeploying href="#upgrading-and-redeploying">Upgrading and Redeploying</a></li> <li><a id=markdown-toc-executor-configuration href="#executor-configuration">Executor Configuration</a> <ul> <li><a id=markdown-toc-initial-installation-and-registration href="#initial-installation-and-registration">Initial Installation and Registration</a></li> <li><a id=markdown-toc-root-path href="#root-path">Root Path</a></li> <li><a id=markdown-toc-accepted-repositories href="#accepted-repositories">Restricting the Accepted Repositories</a></li> </ul> </li> </ul> </li> </ul> <h2 id=installation-options>Installation Options</h2> <h3 id=admin>Admin</h3> <p>There needs to be at least one admin user in Cider-CI. Setting an initial admin or resetting a password at any time later can be performed as in the following example:</p> <p><code>ansible-playbook -i hosts_demo_single play_site.yml -e 'system_admin_password=secret system_admin_login=admin'</code></p> <h3 id=user-interface-theme>User-Interface Theme</h3> <p>The following themes are available: <code>bootstrap-plain</code> (this is the default), <code>bootstrap-theme</code>, <code>cider</code>, and <code>darkly</code>. Any of them can be selected as shown in the following example:</p> <p><code>ansible-playbook -i hosts_demo_single play_site.yml -e 'user_interface_theme=darkly'</code></p> <h3 id=reseting-the-master-secret>Reseting the Master-Secret</h3> <p>The <code>cider_ci_master_secret</code> can be reset at any time by re-invoking the <code>play_site</code> playbook as in the following:</p> <p><code>ansible-playbook -i hosts_demo_single play_site.yml -e 'cider_ci_master_secret=REPLACE-WITH-YOUR-NEW-SECRET'</code></p> <p>Next to resetting all internal passwords (for the database, message queue and internal communication) a new secret will invalidate all session cookies and all secrets for executors to connect immediately. <span class=text-warning> This is a security feature.</span> The user passwords itself remain valid. The executors will be configured with new passwords during the deployment.</p> <h2 id=production-environment>Production Environment</h2> <p>The procedure for installing a production environment is almost the same as for the demo environment.</p> <p>However, the parameters for the example environment are far from optimal. The <a href="https://github.com/cider-ci/cider-ci_deploy">Cider-CI Deploy Project</a> contains the hosts file <code>hosts_zhkd_ci2</code> which is more appropriate to be used as a template in this case. The directories <code>host_vars</code> and <code>group_vars</code> contain further files to be used as templates and to be customized.</p> <p>The server for a production environment should have at least 4GB of memory. A fast file system in particular with respect to <a href="https://de.wikipedia.org/wiki/Input/Output_operations_Per_Second">IOPS</a> is also recommended. Requirements for the executors depend on the use case.</p> <p>The demonstration environment installs the server and one executor on the same machine. This is convenient but usually not a good choice for a productive environment. There are security and reliability issues in particular with respect to the available traits, see <a href="#adding-traits">Adding Traits</a>.</p> <h2 id=upgrading-and-redeploying>Upgrading and Redeploying</h2> <p>Upgrading and redeploying a Cider-CI environment is similar to deploying it for the first time. We update the master project e.g. with <code>git pull</code> and all submodules with <code>git submodule update --init --recursive</code>.</p> <p>From the <code>deploy</code> directory we execute the play_site playbook in the same manner as before, e.g.</p> <p><code>ansible-playbook -i hosts_demo_single play_site.yml -e 'cider_ci_master_secret=REPLACE-WITH-YOUR-SECRET'</code></p> <p>We recommend to upgrade the minor versions in sequence without leaving any out, e.g. from <code>3.5</code>, to <code>3.6</code>, and then to <code>3.7</code>. Upgrades between major versions, e.g. from <code>2.4</code> to <code>3.0</code> may or may be not possible without complications. Please consult the release information.</p> <h2 id=executor-configuration>Executor Configuration</h2> <h3 id=initial-installation-and-registration>Initial Installation and Registration</h3> <p>Every executor must be registered with the server. This is performed automatically when installing the executor via the Ansible <code>play_site</code> playbook. To this end the executor must be registered in the Ansible hosts file. See also the <a href="./">Installation</a> page.</p> <h3 id=root-path>Root Path</h3> <p>The default root location of an installed executor on Linux is <code>/var/local/cider-ci/executor</code>. The scripts are invoked as the user <code>cider-ci_exec-user</code>.</p> <h3 id=accepted-repositories>Restricting the Accepted Repositories</h3> <p>An executor can be configured to only accept trials for certain repositories. This is a security and trust feature. A particular executor might have the possibility to perform deploys or commit to the repository for example. When using this feature it can be ensured that only persons which have permission to push to the original repository can cause actions on this executor.</p> <p>The protection is twofold. The server is programmed to only dispatch accepted repositories to an executor. The executor will at any rate refuse to process trials for repositories it does not accept.</p> <p>Defining accepted repositories is very similar to defining traits. The file <code>/etc/cider-ci/accepted-repositories.txt</code>, and <code>./config/accepted-repositories.txt</code> take a list of comma separated repository URLs. In contrast to traits, if no accepted repositories are defined the executor will accept any repository.</p> <p class="text text-warning">Heads up: the URLs must be equal by case sensitive string comparison!</p> </div> </div> </body> </html>