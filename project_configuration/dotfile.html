<!DOCTYPE html> <html lang=en> <head> <meta charset=utf-8> <meta content='IE=edge' http-equiv=X-UA-Compatible> <meta content='width=device-width, initial-scale=1' name=viewport> <title>Cider-Ci Docs - Dotfile Project Configuration</title> <link href="../assets/stylesheets/app-df49d1b9.css" rel=stylesheet /> <script src="../assets/javascripts/vendor-d2b5dead.js"></script> <script src="../assets/javascripts/app-72be183c.js"></script> </head> <body> <nav class='navbar navbar-inverse navbar-fixed-top'> <div class=container-fluid> <div class=navbar-header> <button aria-controls=navbar aria-expanded=false class='navbar-toggle collapsed' data-target='#navbar' data-toggle=collapse type=button> <span class=sr-only>Toggle navigation</span> <span class=icon-bar></span> <span class=icon-bar></span> <span class=icon-bar></span> </button> <a class=navbar-brand href="../">Cider-CI <span class=semantic-version><span class=major>2</span><span class=minor><span class=divider>.</span>4</span><span class=minor><span class=divider>.</span>0</span><span class=version><span class=divider>-</span>BETA.4</span></span> Documentation </a></div> <div class='navbar-collapse collapse' id=navbar> <ul class='nav navbar-nav'> <li class=dropdown> <a class=dropdown-toggle data-toggle=dropdown href="#"><strong>Project Configuration</strong> <span class=caret></span> </a><ul class=dropdown-menu> <li> <a href="./">Project Configuration </a></li> <li> <a href="dotfile.html">Dotfile </a></li> <li> <a href="specification.html">Build Specification </a></li> <li> <a href="advanced.html">Advanced Topics </a></li> </ul> </li> <li class=dropdown> <a class=dropdown-toggle data-toggle=dropdown href="#"><strong>Development</strong> <span class=caret></span> </a><ul class=dropdown-menu> <li> <a href="../development/architecture/">Architecture </a></li> <li> <a href="../development/setup/">Setup </a></li> </ul> </li> </ul> </div> </div> </nav> <div class=container-fluid> <div class=row> <div class='col-sm-3 col-md-2 sidebar'> <ul class='nav nav-sidebar'> <li class=''> <a class=alike href="./"><strong>Project Configuration</strong> </a></li> <ul class='nav nav-sidebar'> <li class=active> <a href="dotfile.html">Dotfile </a><ul class=toc></ul> </li> </ul> <ul class='nav nav-sidebar'> <li class=''> <a href="specification.html">Build Specification </a></li> </ul> <ul class='nav nav-sidebar'> <li class=''> <a href="advanced.html">Advanced Topics </a></li> </ul> </ul> <ul class='nav nav-sidebar'> <li class=''> <span class=alike> <strong>Development</strong> </span> </li> <ul class='nav nav-sidebar'> <li class=''> <a href="../development/architecture/">Architecture </a></li> </ul> <ul class='nav nav-sidebar'> <li class=''> <a href="../development/setup/">Setup </a></li> </ul> </ul> </div> <div class='col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main'> <div class='alert alert-warning'> This documentation targets Cider-CI <span class=semantic-version><span class=major>2</span><span class=minor><span class=divider>.</span>4</span><span class=minor><span class=divider>.</span>0</span><span class=version><span class=divider>-</span>BETA.4</span></span> which is still in development. </div> <h1 id=dotfile class=no_toc>The Cider-CI Dotfile</h1> <ul id=markdown-toc> <li><a href="#builds">The <em>builds</em> Map</a> <ul> <li><a href="#depends">Declaring Dependencies</a></li> <li><a href="#trigger">Triggering Builds</a></li> </ul> </li> </ul> <p>This page documents the contents of the Cider-CI dotfile <code>.cider-ci.yml</code>. The Cider-CI dotfile defines and specifies available <em>builds</em> and possible relations between builds for a given project.</p> <p>The following example is an extract of the Cider-CI dotfile of the <a href="https://github.com/cider-ci/cider-ci_demo-project-bash">Bash Demo Project for Cider-CI</a>.</p> <div class="highlight yaml"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class=lineno>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34</pre></td><td class=code><pre><span class="c1"># Cider-CI dotfile .cider-ci.yml</span>

<span class="s">builds</span><span class="pi">:</span>

  <span class="s2">"</span><span class="s">Chain-Prerequisite-Demo"</span><span class="pi">:</span> 
    <span class="s">description</span><span class="pi">:</span> <span class="pi">|</span>
      <span class="no">This one serves as a prerequisite to the "Chain-Dependent-Demo".</span>
    <span class="s">specification</span><span class="pi">:</span> 
      <span class="s">_cider-ci_include</span><span class="pi">:</span> <span class="s">/.cider-ci/shared/sleeping_task_context.yml</span>

  <span class="s2">"</span><span class="s">Chain-Dependent-Demo"</span><span class="pi">:</span> 
    <span class="s">description</span><span class="pi">:</span> <span class="pi">|</span>
      <span class="no">This demo can only be started if the "Chain-Prerequisite-Demoe" has</span>
      <span class="no">passed. There is also a trigger which will start this demo when the</span>
      <span class="no">prerequisite has finished and the commit is part of the head of</span>
      <span class="no">a brach matching the given regular expression. </span>
    <span class="s">specification</span><span class="pi">:</span> 
      <span class="s">_cider-ci_include</span><span class="pi">:</span> <span class="s">/.cider-ci/shared/sleeping_task_context.yml</span>
    <span class="s">depends</span><span class="pi">:</span>
      <span class="s">builds</span><span class="pi">:</span>
        <span class="s2">"</span><span class="s">Chain-Prerequisite-Demo"</span><span class="pi">:</span> <span class="s">passed</span>
        <span class="s2">"</span><span class="s">Trigger-Demo"</span><span class="pi">:</span> <span class="s">passed</span>
    <span class="s">trigger</span><span class="pi">:</span> <span class="s">true</span>


  <span class="s2">"</span><span class="s">Trigger-Demo"</span><span class="pi">:</span> 
    <span class="s">description</span><span class="pi">:</span> <span class="pi">|</span>
      <span class="no">This execution will be automatically run when a commit containing it</span>
      <span class="no">becomes the head of a branch. The `trigger` property accepts the same</span>
      <span class="no">values as the `depends` property.</span>
    <span class="s">specification</span><span class="pi">:</span>
      <span class="s">_cider-ci_include</span><span class="pi">:</span> <span class="s">/.cider-ci/shared/sleeping_task_context.yml</span>
    <span class="s">trigger</span><span class="pi">:</span> 
      <span class="s">branch</span><span class="pi">:</span> <span class="s2">"</span><span class="s">^master|wip.*$"</span>
</pre></td></tr></tbody></table> </div> <h1 id=builds>The <em>builds</em> Map</h1> <p>The keys of the <em>builds</em> map name available builds for reference. The values describe, specify and relate them.</p> <table class="table table-striped"> <thead> <tr> <th>Key</th> <th>Required</th> <th>Value</th> </tr> </thead> <tbody> <tr> <td><code>specification</code></td> <td>yes</td> <td>Map, see the <a href="specification.html">Build Specification</a> page</td> </tr> <tr> <td><code>description</code></td> <td>no</td> <td>String, describes the build, plain text or markdown</td> </tr> <tr> <td><code>depends</code></td> <td>no</td> <td>Map, see the <a href="#depends">Declaring Dependencies</a> section</td> </tr> <tr> <td><code>trigger</code></td> <td>no</td> <td>Boolean true value or Map, see the <a href="#trigger">Triggering Builds</a> section</td> </tr> </tbody> </table> <h2 id=depends>Declaring Dependencies</h2> <p>The <code>depends</code> key declares a build to be dependent on either an other build or the belonging to a branch. A build which has unsatisfied dependencies can not be started. </p> <p>Builds for a given commit (<code>tree_id</code> precisely) can depend on each other by specifying a build name and the desired state of that build. </p> <div class="highlight yaml"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class=lineno>1
2
3
4</pre></td><td class=code><pre><span class="s">depends</span><span class="pi">:</span>
  <span class="s">builds</span><span class="pi">:</span>
    <span class="s2">"</span><span class="s">Chain-Prerequisite-Demo"</span><span class="pi">:</span> <span class="s">passed</span>
    <span class="s2">"</span><span class="s">Trigger-Demo"</span><span class="pi">:</span> <span class="s">passed</span>
</pre></td></tr></tbody></table> </div> <p>Builds can depend on their belonging to a certain branch. This is done in the very same way as declaring triggers on branches. See the following section. </p> <h2 id=trigger>Triggering Builds</h2> <p>Builds will be automatically started if the conditions specified by the <code>trigger</code> directive and their dependencies are satisfied. </p> <p>The value of the <code>trigger</code> direcative can have one multiple types. A boolean true value is the simplest case: </p> <div class="highlight yaml"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class=lineno>1
2
3</pre></td><td class=code><pre><span class="s">builds</span><span class="pi">:</span>
  <span class="s2">"</span><span class="s">Chain-Dependent-Demo"</span><span class="pi">:</span> 
    <span class="s">trigger</span><span class="pi">:</span> <span class="s">true</span>
</pre></td></tr></tbody></table> </div> <p>The value of <code>trigger</code> can be a map where the keys <code>builds</code> and <code>branch</code> are honored. The value of the <code>builds</code> key can be exactly the same as described in <a href="#depends">Declaring Dependencies</a>, we will not repeat it here. The value of the <code>branch</code> key is always a string. Names of branches can be matched by either case sensitive comparison or by regular expression matching. Regualar expression maching will be performed if and only if the string starts with a <code>^</code> character. </p> <div class="highlight yaml"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class=lineno>1
2
3
4</pre></td><td class=code><pre><span class="s">builds</span><span class="pi">:</span>
  <span class="s2">"</span><span class="s">Trigger-Demo"</span><span class="pi">:</span> 
    <span class="s">trigger</span><span class="pi">:</span> 
      <span class="s">branch</span><span class="pi">:</span> <span class="s2">"</span><span class="s">^master|wip.*$"</span>
</pre></td></tr></tbody></table> </div> <p>Triggers are evaluated when an event realted to the <code>tree_id</code> happens. This includes:</p> <ul> <li>A by the <code>tree_id</code> related commit becomes the head of a branch.</li> <li> <p>Some other build with the same <code>tree_id</code> changes into a final state.</p> </li> </ul> </div> </div> </div> </body> </html>