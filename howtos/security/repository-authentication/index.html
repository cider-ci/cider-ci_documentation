<!DOCTYPE html> <html lang=en> <head> <meta charset=utf-8> <meta content='IE=edge' http-equiv=X-UA-Compatible> <meta content='width=device-width, initial-scale=1' name=viewport> <title>Cider-CI Docs</title> <link href="../../../assets/stylesheets/app-30beb77e.css" rel=stylesheet /> <script src="../../../assets/javascripts/vendor-ce938919.js"></script> <script src="../../../assets/javascripts/app-72be183c.js"></script> </head> <body id=the-cider-ci-documentation> <div class=container> <nav class='navbar navbar-inverse'> <div class=container-fluid> <div class=navbar-header> <a class=navbar-brand href="../../../">Cider-CI <span class=semantic-version><span class=major>3</span><span class=divider>.</span><span class=minor>14</span></span> Documentation </a></div> <form action='https://www.google.com/search' class='navbar-form navbar-left' method=get role=search> <div class=form-group> <input name=as_sitesearch type=hidden value='docs.cider-ci.info'> <input name=hl type=hidden value=en> <input class=form-control name=as_q placeholder=Search> <button class='btn btn-default' style='display: none' type=submit>Submit</button> </div> </form> <ul class='nav navbar-nav'> <li> <a href="../../../introduction/">Introduction </a></li> <li> <a href="../../../introduction/quick-start/">Quick-Start </a></li> <li> <a href="../../../sitemap.html">Sitemap </a></li> </ul> </div> </nav> <div class=row> <div class=col-md-6> <ol class=breadcrumb> <li> <a href="../../../">Home </a></li> <li> <a href="../../">Howtos </a></li> <li> <a href="./">Repository Authentication </a></li> </ol> </div> <div class=col-md-6> </div> </div> <div class=content> <h1 id=repository-authentication>Repository Authentication</h1> <p>Depending on the protocol and configuration of the remote git endpoint authentication might be required to access repositories.</p> <p>The SSH protocol requires authentication due to its nature. The HTTP protocol requires authentication for git pushes (rarely implemented within a CI infrastructure) and for pulls if the remote is configured that way. So called <em>private</em> repositories in GitHub parlance require authentication by default.</p> <p>The key to implement authentication for Cider-CI is to understand which users are involved. The following facts are valid for a standard installation via the <a href="https://github.com/cider-ci/cider-ci_deploy">Cider-CI Deploy Project</a>, see also the <a href="../../../installation/">Installation</a> guides.</p> <pre><code>┌────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                                                                                                │
│                                         Remote Git Repository / Server                                         │
│                                                                                                                │
└───────────────┬─────────────────────────────┬─────────────────▲────────────────────────┬──────────────▲────────┘
                │                             │                                          │
                │                             │                 │                        │              │
                │                             │                                          │
           clone/fetch                   clone/fetch     push (optional)            clone/fetch   push (optional)
                │                             │                                          │
                │                             │                 │                        │              │
                │                             │                                          │
┌───────────────┼───────────────┐     ┌───────┼─────────────────┼───────────┐    ┌───────┼──────────────┼────────┐
│               ▼               │     │       ▼                             │    │       ▼                       │
│  ┌─────────────────────────┐  │     │  ┌────────┐  ┌──────────┴─────────┐ │    │   ┌──────────────────┴─────┐  │
│  │   cider-ci_repository   │  │     │  │  root  │  │ cider-ci_exec-user │ │    │   │   cider-ci_executor    │  │
│  └─────────────────────────┘  │     │  └────────┘  └────────────────────┘ │    │   └────────────────────────┘  │
│                               │     │                                     │    │                               │
│        Cider-CI Server        │     │       Cider-CI Linux Executor       │    │   Cider-CI Windows Executor   │
│                               │     │                                     │    │                               │
└───────────────────────────────┘     └─────────────────────────────────────┘    └───────────────────────────────┘
</code></pre> <h2 id=users>Users</h2> <p>Cider-CI uses standard <code>git</code> system commands to access remote repositories. On the server the user <code>cider-ci_repository</code> clones and fetches from remote repositories. Therefore the <code>cider-ci_repository</code> must have read access to the remote repository.</p> <p>On a Linux executor the executor service runs under <code>root</code>. Scripts are executed under the <code>cider-ci_exec-user</code>. Therefore to clone and fetch repositories in the normal workflow the <code>root</code> user must be granted read access. If any git integration is to be performed as part of a <code>Cider-CI Job</code> then the <code>cider-ci_exec-user</code> has to be granted access. If follows that pull and push privileges are separated by default.</p> <p>On a Windows executor the user <code>cider-ci_executor</code> pulls and runs the corresponding scripts. <span class=text-warning> Separating push and pull privileges must be implemented on the remote git server if there is a Windows executor involved. </span></p> <h2 id=protocols>Protocols</h2> <p>We investigate some of the obstacles imposed by the protocols.</p> <h3 id=http--https>HTTP / HTTPS</h3> <p>It is technically possible to integrate the <code>username:password</code> as part of the URI for the <code>http/https</code> protocol. This is probably the most easy approach but it is also vulnerable. By accident (or by provoking exceptions) the password could appear in logfiles or other channels. We only recommend this method for non public repositories and better yet non public accessible Cider-CI instances. Additionally check that all the users of the Cider-CI instance can be trusted with this information.</p> <p>One alternative to URLs is the <code>.netrc</code> file. This comes via <code>libcurl</code> which is used by <code>git</code>. See the <a href="http://curl.haxx.se/docs/manual.html">Curl Manual</a>.</p> <h3 id=ssh>SSH</h3> <p>Access can be granted by creating a ssh key pair and enabling the public key on the remote server. There is one particular trip hazard: SSH services are usually configured not to allow connections to remote hosts which are not white-listed. Connecting once to the remote as the target user will reveal problems and might even provide a solution by adding a line to the <code>known_hosts</code> file interactively.</p> </div> </div> </body> </html>